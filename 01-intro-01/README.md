# Жизненный цикл разработки нового функционала интернет-магазина

## Роли (участники процесса)

- конечный пользователь;
- сотрудник службы поддержки;
- тестировщик;
- маркетолог;
- менеджер проекта;
- разработчик;
- технический писатель;
- специалист DevOps (далее просто DevOps для краткости).

## Краткий список шагов разработки

- сообщение об ошибке в приложении от пользователя;
- проверка наличия ошибки и способа её воспроизведения;
- запрос на новый функционал;
- создание нового функционала;
- исправление ошибок;
- тестирование нового функционала;
- проверка исправления ошибки;
- проверка нового функционала на соответствие требованиям;
- написание документации по новому функционалу;
- сборка релиза;
- развёртывание релиза на проде;
- мониторинг функционирования.

## Описание шагов разработки

На всех шагах разработки *DevOps* обеспечивает всем остальным участникам процесса доступ к необходимым им инструментам и информации (система контроля задач, система контроля версий, окружения для тестирования, и т.д.), и одновременно ограничивает доступ к тем, которые должны быть недоступны/не нужны для выполнения работы.

### Сообщение об ошибке в приложении от пользователя

*Конечный пользователь* сообщает об ошибке *сотруднику службы поддержки*, который, в случае невозможности решить проблему самостоятельно, заводит тикет в системе контроля задач. 

Система контроля задач используется *DevOps* для настройки процесса разработки и контроля происходящих процессов.

### Проверка наличия ошибки и способа её воспроизведения

*Тестировщик* на основании тикета о проблеме пользователя исследует причины возникновения проблемы, подготавливает для *разработчика* подробный технический отчёт о проблеме, включающий методы её воспроизведения. В идеале *тестировщик* создает автоматический функциональный тест по проблеме. *Менеджер* оценивает критичность ошибки и выставляет для тикета приоритет исполнения. 

*DevOps* обеспечивает возможность тестировщику создать новый тест с использованием необходимых инструментов и разместить его в системе контроля версий, и обеспечивает его автоматический запуск при тестировании.

### Запрос на новый функционал

*Маркетолог* делает запрос на новый функционал системы. *Менеджер* совместно с *разработчиком* оценивают реализуемость и срок реализации, после чего *менеджер* заводит тикет в системе контроля задач.

### Создание нового функционала и Исправление ошибок

*Разработчик* создает новый функционал/исправляет ошибки, включая необходимые тесты (юнит, функциональные и т.д.), и размещает новый код в системе контроля версий в новой ветке.

*DevOps* обеспечивает автоматическое тестирование кода в новой ветке при её создании. При этом автоматически создаётся новое окружение для тестирования и запускаются все тесты. Результаты тестирования отправляются разработчику. Если тестирование завершилось неуспешно, *разработчик* должен исправить код.

После успешного тестирования, *разработчик* проходит этап code review, внося необходимые исправления в код и снова проходя через этап автоматического тестирования.

*DevOps* также следит за результатами автоматического тестирования, в частности, за метриками качества покрытия кода тестами. В случае недостаточности тестирования, информация об этом передаётся *разработчику*, от которого ожидается добавление необходимых тестов.

Кроме этого, *DevOps* должен также обеспечить контроль наличия возможности и правильности выполнения отката изменений в новой версии (кода, структуры и данных БД, и т.д.) до состояния предыдущей.

### Тестирование нового функционала, Проверка исправления ошибки и Проверка нового функционала на соответствие требованиям

После того как *разработчик* закончил написание нового кода, и автоматические тесты пройдены успешно, результат работы должен быть проверен *тестировщиком* на правильность работы. В случае обнаружения ошибок в работе, *тестировщик* возвращает тикет на доработку, в идеале создавая новый функциональный тест для найденной ошибки.

После успешного прохождения тестирования, результаты работы изучают *маркетолог* (на соответствие результата ожидаемому) и *менеджер* (общая проверка).

*DevOps* на данном шаге создаёт возможность развернуть полноценное окружение для ручного тестирования нужной ветки кода и предоставляет доступ к этой ветке *тестировщику*, *маркетологу* и *менеджеру*.

### Написание документации по новому функционалу

После одобрения выполненной работы, её результаты должны быть зафиксированы в документации.

*DevOps* обеспечивает *техническому писателю* доступ к окружению с развёрнутой веткой кода, которую необходимо описать, и поддерживает процессы формирования документации из исходных файлов, создаваемых *техническим писателем*.

### Сборка релиза

Периодически *разработчиком* выполняется сборка всех изменений функционала и единую кодовую базу -- создание очередного релиза. Данный процесс выполняется в отдельной ветке, и проходит шаги тестирования, проверки и исправления документации принципиально так же, как и обычные ветки кода. При этом бОльшее внимание уделяется ручным функциональным и интеграционным тестам, и они выполняются все, а не только касающиеся дополнений и изменений функционала.

### Развёртывание релиза на проде

На данном шаге *DevOps* обеспечивает автоматическую выкладку релизной ветки на промышленное окружение, с учетом требований к непрерывности функционирования системы.

В идеале процесс развёртывания нового релиза должен быть проверен в специальном тестовом окружении, в том числе включая проверку правильности выполнения отката на предыдущую версию. 
Эти процессы должны быть по максимуму автоматизированы.

В случае возникновения проблем при развёртывании релиза на промышленном окружении, выполняется откат на предыдущую версию с информированием *разработчика* о возникшей проблеме.

### Мониторинг функционирования

Все используемые в процессе разработки системы, в особенности промышленное окружение, должны находиться под постоянным мониторингом, включая, в том числе, аппаратные проблемы. Уведомления о проблемах автоматически рассылаются ответственным за их решение. Как правило, некритичные проблемы проходят через *сотрудника службы поддержки*, который решает их, либо же сообщает о критичных проблемах ответственным за данные сбои.

*DevOps* обеспечивает настройку сбора информации об ошибках, автоматическую рассылку уведомлений о них и доступ сотрудников к логам, требуемым для решения проблем. 